# smartDorm
â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—» <br>
<h3>ğŸŸ« ä½¿ç”¨çš„ææ–™</h3>
1. è¶…éŸ³æ³¢è·é›¢æ„Ÿæ¸¬å™¨ HC-SR04<br>
2. ç¹¼é›»å™¨æ¨¡çµ„<br>
3. WS2812 LED x60<br>
4. Arduino UNO<br>
5. PC or Raspberry PI 3B<br>
<br>
â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»â—»<br>
<br>
<h3>ğŸ’¡ å®‰è£ä¸€å€‹è‡ªå‹•åŒ–æ§åˆ¶å®¿èˆæ¡Œä¸Šçš„æª¯ç‡ˆ</h3>

- [ ] æº–å‚™å¥½ä¸Šè¿°ææ–™
- [ ] å°‡Arduino ç·šè·¯æ¥å¥½ (è…³ä½é…ç½®æ–¼Arduino code)
  - Trig Pin = 10
  - Echo Pin = 9
  - Relay Pin = 8
  - WE2812 LED Pin = 5
- ç›®å‰åƒ…é–‹æºè‡³æ­¤ (APIåŠå…¶ä»–åŠŸèƒ½ç›®å‰å› éœ€googleå¸³è™Ÿï¼Œæ•…åƒ…ä¾›å€‹äººä½¿ç”¨)

<br>
v2.0
ç‚ºæ¸›è¼•é›»è…¦è² æ“”ï¼Œå°‡ä¸Šå‚³è³‡æ–™å·¥ä½œäº¤ç”± Raspberry PI 3B<br>

========================================<br>
ğŸŸ¦ Arduinoè² è²¬è»Ÿç¡¬é«”ï¼š<br>
- è¶…è²æ³¢HC-SR04 åˆ¤æ–·åº§ä½å‰æ–¹è·é›¢(cm) <br>
![20230312_155936](https://user-images.githubusercontent.com/52557611/224533636-3deba800-9bbf-4b24-af16-cb10af14a1af.jpg)
![20230312_164517](https://user-images.githubusercontent.com/52557611/224534057-08bf7a03-9a30-4226-beea-5a533c9f66c3.jpg)

- æ ¹æ“šæ¢ä»¶åˆ¤æ–·é–‹é—œç‡ˆæ™‚æ©Ÿ (debounce)<br>
  - è¶…é115cm é—œç‡ˆ
  - å°‘æ–¼ 85cm é–‹ç‡ˆ
  
![20230312_164256](https://user-images.githubusercontent.com/52557611/224533972-a9600f35-b98c-4d99-885f-5ee16261475d.jpg)
![20230312_164647](https://user-images.githubusercontent.com/52557611/224534145-7167a4df-d977-4176-bb35-ccb26818387c.jpg)

- ä¾æ“šæ¨¡å¼ä¸åŒé…ç½®WS2812 LEDs<br>
  - é–‹ç‡ˆæ™‚æ ¹æ“šè·é›¢è®Šæ›é¡è‰²(é›¢è¢å¹•è¶Šè¿‘è¶Šç´…ï¼Œè¶Šé è¶Šç¶ );<br>å‰20é¡†ä¿æŒé–ƒçˆæµªæ¼«é»ƒç‡ˆ
  - é—œç‡ˆæ™‚æ•´æ¢é¡¯ç¤ºå¼±å…‰åŒè‰²æµªæ¼«ç‡ˆå…‰ï¼ŒæŒçºŒè®Šè‰²ç´„1å°æ™‚å€™é—œé–‰
- åœ¨è§¸ç™¼é–‹/é—œç‡ˆæ™‚é€éåºåˆ—é˜œé€å‡ºç‹€æ…‹<br>
- ç¨ç«‹é‹ä½œåƒ…éœ€ä¾›é›»å³å¯ä½¿ç”¨
<br>
ğŸ”´ğŸ”´ğŸ”´ğŸ”´ğŸ”´ğŸ”´ v2.0 åŠŸèƒ½ ç›®å‰åƒ…é–‹æºè‡³ä»¥ä¸ŠåŠŸèƒ½ ğŸ”´ğŸ”´ğŸ”´ğŸ”´ğŸ”´ğŸ”´<br><br><br>
========================================<br>
ğŸŸ¥ Raspberry PI è² è²¬æºé€šï¼š<br><br>
- æ‰€æœ‰åŠŸèƒ½å·²åŒ…è£æˆDocker Imageä¸¦ä¸Šå‚³Docker Hub
- çŒå¥½PI OSåƒ…éœ€é‹è¡Œcontainerå³å¯å‹•ä½œ

    docker run -d --restart always -p 8080:8080 --privileged --device=/dev/ttyUSB0 dongdonghsu/dormpiapp:lastest

- éœ€é€éNATæŠ€è¡“æ‰“ç©¿å¤–ç¶²è«‹æ±‚(8080 port)ï¼Œæ¨è–¦ä½¿ç”¨ [PiTunnel(å¾Œä¾†ç™¼ç¾åƒ…14å¤©å…è²»è©¦ç”¨)](https://www.pitunnel.com/)
- å¯ä»¥ä½¿ç”¨[cpolar](https://dashboard.cpolar.com)ï¼Œé›–ç„¶IPæœƒæµ®å‹•ï¼Œä½†æ˜¯å¯ä»¥çˆ¬è¡æ›´æ–°

1. é€éUSBåºåˆ—é˜œå’Œ ArduinoæŒçºŒæºé€š<br>
2. æ”¶åˆ°æ–°ç‹€æ…‹å‰‡ç™¼é€HTTP GET request to GAP API<br>
3. æœ¬èº«ä½œç‚ºå¤–éƒ¨çš„ä¸€å°API serverå¯ä¾›å¤–éƒ¨åšGET Requestè§¸ç™¼pyhton script(sw.py)
![20230312_164322](https://user-images.githubusercontent.com/52557611/224533997-94f0f8f5-ee9b-45ff-919f-05fdcd2c76fa.jpg)

========================================<br>
ğŸŸ§ é›²ç«¯Google App Script (GAS) è² è²¬ APIç«¯å£ï¼š<br>
1. æ¥æ”¶è³‡æ–™ä¸²å…¥åšåˆ¤æ–· <br>
2. åŠ ä¸Š Time code å¾Œå°‡è³‡æ–™è¼¸å‡ºè‡³Google sheet <br>
3. é€é Google è‡ªå®¶ç”Ÿæ…‹éˆåˆ©ç”¨ GAS æ’ç‰ˆ Google Sheet <br>

ğŸŸ© Google Sheet 
- è½‰æ›ç´¯è¨ˆåˆ†é˜æ•¸ç‚ºæ˜“è®€å…¬å¼ï¼š
    =TEXT(SUM(D3:D)/60,"0")&"å°æ™‚ï¼š"&MOD(SUM(D3:D),60)&"åˆ†"
    
- åˆ¤æ–·é›¢é–‹æ™‚é–“æ¢ä»¶æ ¼å¼è¨­å®šå…¬å¼ï¼š
    =(IF(NOT(ISBLANK(D4)),"true","false"))="true"

- åˆ¤æ–·åä¸‹æ™‚é–“æ¢ä»¶æ ¼å¼è¨­å®šå…¬å¼ï¼š
    =(IF(NOT(ISBLANK(D6)),"true","false"))="true"
    
- åœ–è¡¨æ ¼å¼è¨­å®šï¼š
![image](https://user-images.githubusercontent.com/52557611/224533583-99f4b4e1-5dd5-43af-82aa-3d4675445682.png)

========================================<br>
DEMO: <br>
![image](https://user-images.githubusercontent.com/52557611/224530371-9bab8421-0825-483d-80f9-b56bc1333983.png)
> åˆ©ç”¨è©¦ç®—è¡¨æ¢ä»¶æ ¼å¼è¨­å®šå…¬å¼åˆ†è¾¨ï¼ŒğŸŸ¥ç´…è‰²ï¼šåä¸‹æ™‚é–“ã€â¬œç°è‰²ï¼šé›¢é–‹æ™‚é–“ä»¥åŠå–®æ¬¡æ‰€å¾…çš„æ™‚é–“é•·åº¦

![image](https://user-images.githubusercontent.com/52557611/200508630-db91f790-70d0-4f37-9a2f-77011b82b5fb.png)
![image](https://user-images.githubusercontent.com/52557611/200508716-a0b63234-7bbd-4126-899f-baeafdf9d480.png)
